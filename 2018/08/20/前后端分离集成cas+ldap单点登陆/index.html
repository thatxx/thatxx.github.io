<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="gxii,xx.wand@gmail.com"><title>前后端分离项目接入CAS单点登陆 · gxii's blog</title><meta name="description" content="本篇内容为在项目前后端分离的情况下，接入cas单点登陆。先介绍下相关的概念
单点登陆与LDAP单点登陆在高度信息化的情况下，一个企业会使用不同的多个系统，同时也必然涉及企业人员的账号登陆。如果企业人员使用每个系统都需要重复登陆，将大大影响用户体验，同时也不利于人员信息的同步。所以单点登陆应运而生，用"><meta name="keywords" content="Hexo,HTML,CSS,java,full-stack"><meta content="#f5f5f5" name="msapplication-navbutton-color"><meta name="theme-color" content="#f5f5f5"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">gxii's blog</a></h3><div class="description"><p>乍见之欢 久处不厌</p></div></div></div><ul class="social-links"><li><a href="http://instagram.com/gxii_"><i class="fa fa-instagram"></i></a></li><li><a href="http://weibo.com/137908080"><i class="fa fa-weibo"></i></a></li><li><a href="http://github.com/thatxx"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li><li><a href="/about">关于</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img src="/images/avatar.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>前后端分离项目接入CAS单点登陆</a></h3></div><div class="post-content"><p>本篇内容为在项目前后端分离的情况下，接入cas单点登陆。<br>先介绍下相关的概念</p>
<h3 id="单点登陆与LDAP"><a href="#单点登陆与LDAP" class="headerlink" title="单点登陆与LDAP"></a>单点登陆与LDAP</h3><h5 id="单点登陆"><a href="#单点登陆" class="headerlink" title="单点登陆"></a>单点登陆</h5><p>在高度信息化的情况下，一个企业会使用不同的多个系统，同时也必然涉及企业人员的账号登陆。如果企业人员使用每个系统都需要重复登陆，将大大影响用户体验，同时也不利于人员信息的同步。所以单点登陆应运而生，用户只要登陆一次便可访问多个不同的系统。CAS即是Yale大学发起的一个企业级的、开源的单点登陆框架。</p>
<h5 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h5><p>同一企业的不同应用系统中会都需要存储使用人员信息，既然有了单点登陆，那么我们可以将人员的信息集中与一处进行管理更新，在用户登陆同时一并提供用户的人员信息，降低多个系统间对接、维护人员信息的成本。<br>LDAP的全名是轻型目录访问协议，LDAP以树形结构来管理数据，因此特别适合查询层级结构明显的数据，常见的应用就是管理组织内的人员、设备信息。人员信息以LADP的方式表现如下：<br><img src="/images/LADP人员信息.jpg" alt="LADP人员信息"><br>上图的人员信息用字符串可以表示为：cn=baby,ou=marketing,ou=people,dc=mydomain,dc=org。<br>LADP的相关概念查看此处：<a href="https://segmentfault.com/a/1190000002607140" target="_blank" rel="external">LADP相关概念</a></p>
<h3 id="CAS基本原理"><a href="#CAS基本原理" class="headerlink" title="CAS基本原理"></a>CAS基本原理</h3><p>CAS框架主要分为两部分，一个是提供用户认证的CAS Server，另一个是负责对需要登陆的资源进行拦截保护的CAS Client。CAS Client通常以过滤器的形式集成到应用中，当用户在未登录的情况下访问应用，CAS Client会其拦截并重定向到CAS Server让用户进行登陆。<br>使用CAS框架进行单点的常见步骤如下：</p>
<ol>
<li>用户通过客户端对服务端发起请求  </li>
<li>服务端（CAS Client）发现用户没有登陆过，将客户端其重定向至CAS Server提供的单点登陆页面，附带上回调地址（ServiceId）  </li>
<li>用户在单点登录页进行登陆  </li>
<li>CAS Server验证用户身份后，先发放TGT票据（Ticket Granting ticket），然后再根据TGT发放ST票据（Service Ticket），如果用户先前已经登陆过，则略去上一步，直接根据用户已有的TGT票据发放ST票据。  </li>
<li>客户端将获取的ST票据传递给服务端，服务端（CAS Client）拿着ST票据去向CAS Server验证真伪    </li>
<li>CAS Server验证ST票据通过后，向服务端（CAS Client）返回相关的用户信息，至此用户登陆成功。</li>
</ol>
<p>具体的验证流程图如下：<br><img src="/images/CAS验证流程.jpg" alt="CAS验证流程图"><br>ST票据(Service ticket)：服务票据，包含服务信息的。用户只能特定一ST票据访问特定服务。类似OAuth2中的ACCESS_TOKEN<br>TGT票据(Ticket Granting ticket)：票据授权票据。拥有该票据的情况下，申请各种其他ST票据时便不用登陆认证<br>TGC(Ticket-granting cookie)：存放TGT票据的cookie，在浏览器和CAS Server间通讯时使用。类似OAuth2中的REFLESH_TOKEN<br>更多CAS相关概念查看此处：<a href="https://blog.csdn.net/cruise_h/article/details/51013597" target="_blank" rel="external">CAS相关概念</a>  </p>
<h3 id="前后端分离"><a href="#前后端分离" class="headerlink" title="前后端分离"></a>前后端分离</h3><p>在传统的Spring MVC应用中，前端页面的跳转显示可以由后台控制，接入CAS单点登陆只要配置好相关的过滤器既可。<br>但是在前后端分离的情况下，前端页面的跳转显示后台无法控制，因此需要按照CAS单点登陆的步骤手动处理。</p>
<h3 id="EOF"><a href="#EOF" class="headerlink" title="EOF"></a>EOF</h3></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-08-20</span><i class="fa fa-comment-o"></i><a href="/2018/08/20/前后端分离集成cas+ldap单点登陆/#comments">评论</a><i class="fa fa-tag"></i><a href="/categories/架构设计/" title="架构设计" class="tag">架构设计 </a><a href="/tags/cas-ldap-前后端分离/" title="cas ldap 前后端分离" class="tag">cas ldap 前后端分离 </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://yoursite.com/2018/08/20/前后端分离集成cas+ldap单点登陆/,gxii's blog,前后端分离项目接入CAS单点登陆,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a role="navigation" href="/2018/01/05/接口Token设计/" title="接口Token的设计" class="btn">下一篇</a></li></ul></div><a id="comments"></a><div id="disqus_thread"></div><script>var disqus_shortname = 'gxii';
var disqus_identifier = '2018/08/20/前后端分离集成cas+ldap单点登陆/';
var disqus_title = '前后端分离项目接入CAS单点登陆';
var disqus_url = 'http://yoursite.com/2018/08/20/前后端分离集成cas+ldap单点登陆/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//gxii.disqus.com/count.js" async></script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>